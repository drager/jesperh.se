<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Falcor for dart</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Roboto+Slab">

    <link rel="canonical" href="https://jesperh.se">
    <meta name="referrer" content="origin">

    <meta property="og:site_name" content="Jesper Håkansson">
    <meta property="og:description" content="Studies web development. Dart, JS and opensource lover.">

      <meta property="og:site_name" content="Jesper Håkansson">
      <meta property="og:type" content="website">
      <meta property="og:title" content="Jesper Håkansson">
      <meta property="og:url" content="https://jesperh.se">
      <meta property="og:image" content="https://jesperh.se/assets/logo.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Jesper Håkansson">
    <meta name="twitter:description" content="Studies web development. Dart, JS and opensource lover.">
    <meta name="twitter:url" content="https://jesperh.se">
    <meta name="twitter:image:src" content="https://jesperh.se/assets/logo.png">

    <link rel="alternate" type="application/rss+xml" title="Jesper Håkansson" href="https://jesperh.se/rss/">
        <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Article",
        "publisher": "Jesper Håkansson",
        "author": {
        "@type": "Person",
          "name": "Jesper Håkansson",
          "url": "https://jesperh.se/author/jesper",
          "sameAs": "https://github.com/drager"
        },
        "headline": "Falcor for dart",
        "url": "https://jesperh.se/falcor-for-dart",
        "datePublished": "2015-10-04T00:00:00.000Z",
        
        
        "inLanguage": "en",
        
        "description": "Rasmus and I have for a while been working on to port the
FalcorJS router built by Netflix to Dart."
      }
    </script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-34213271-2', 'auto');
ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class="site-header">
      
    <nav>
      <a class="subscribe-button icon-feed" href="/rss/">Subscribe</a>
      <a class="back-button icon-arrow-left" href="/">Home</a>
    </nav>


    </header>
    <main>
      
    <article lang="en" class="post">
      <header>
        <h1>Falcor for dart</h1>
        <time datetime="2015-10-04T00:00:00.000Z">October 4, 2015</time>
      </header>

      <section class="post-content">
        <p><a href="https://rasmus.eneman.eu">Rasmus</a> and I have for a while been working on to port the
<a href="http://netflix.github.io/falcor">FalcorJS router</a> built by Netflix to Dart.</p>
<p>We have been working hard to get all the FalcorJS tests to pass in Dart and we are finally
proud to announce that the Dart version is ready and it is available at
<a href="https://pub.dartlang.org/packages/falcor_dart">pub</a>. But keep in mind, as the Falcor team states
in their repository: <strong>This release is a developer preview</strong>.</p>
<p>For those who are interested at helping out or looking at the source it is available at <a href="https://github.com/Pajn/falcor_dart">Github</a>.</p>
<p>It also provides a binding to shelf which is optional to use but easy to get started with.</p>
<p>Example using shelf:</p>
<pre><code class="language-dart">
<span class="token keyword" >import</span> <span class="token string" >'package:shelf/shelf.dart'</span> <span class="token operator" >as</span> shelf<span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token string" >'package:shelf/shelf_io.dart'</span> <span class="token operator" >as</span> io<span class="token punctuation" >;</span>

<span class="token keyword" >import</span> <span class="token string" >'package:falcor_dart/router.dart'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token string" >'package:falcor_dart/shelf.dart'</span><span class="token punctuation" >;</span>

<span class="token comment" spellcheck="true">/// Example using shelf binding</span>
<span class="token function" >main</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token keyword" >async</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >final</span> todoService <span class="token operator" >=</span> <span class="token keyword" >new</span> <span class="token class-name" >TodosService</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  <span class="token keyword" >final</span> falcorHandler <span class="token operator" >=</span> <span class="token keyword" >await</span> <span class="token function" >createFalcorHandler</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>_<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token keyword" >new</span> <span class="token class-name" >Router</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span>
      <span class="token function" >route</span><span class="token punctuation" >(</span><span class="token string" >'todos.name'</span><span class="token punctuation" >,</span> <span class="token keyword" >get</span><span class="token punctuation" >:</span> <span class="token punctuation" >(</span>_<span class="token punctuation" >)</span> <span class="token keyword" >async</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >var</span> todoList <span class="token operator" >=</span> <span class="token keyword" >await</span> todoService<span class="token punctuation" >.</span><span class="token function" >getTodoList</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

        <span class="token keyword" >return</span> <span class="token punctuation" >{</span>
          <span class="token string" >'path'</span><span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'todos'</span><span class="token punctuation" >,</span> <span class="token string" >'name'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
          <span class="token string" >'value'</span><span class="token punctuation" >:</span> todoList<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>todo<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> todo<span class="token punctuation" >[</span><span class="token string" >'name'</span><span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
        <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
      <span class="token function" >route</span><span class="token punctuation" >(</span><span class="token string" >'todos.length'</span><span class="token punctuation" >,</span> <span class="token keyword" >get</span><span class="token punctuation" >:</span> <span class="token punctuation" >(</span>_<span class="token punctuation" >)</span> <span class="token keyword" >async</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >var</span> todoList <span class="token operator" >=</span> <span class="token keyword" >await</span> todoService<span class="token punctuation" >.</span><span class="token function" >getTodoList</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

        <span class="token keyword" >return</span> <span class="token punctuation" >{</span>
          <span class="token string" >'path'</span><span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'todos'</span><span class="token punctuation" >,</span> <span class="token string" >'length'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
          <span class="token string" >'value'</span><span class="token punctuation" >:</span> todoList<span class="token punctuation" >.</span>length<span class="token punctuation" >,</span>
        <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  <span class="token keyword" >var</span> handler <span class="token operator" >=</span> <span class="token keyword" >const</span> shelf<span class="token punctuation" >.</span><span class="token function" >Pipeline</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>
      <span class="token punctuation" >.</span><span class="token function" >addMiddleware</span><span class="token punctuation" >(</span>shelf<span class="token punctuation" >.</span><span class="token function" >logRequests</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
      <span class="token punctuation" >.</span><span class="token function" >addHandler</span><span class="token punctuation" >(</span>falcorHandler<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  <span class="token keyword" >var</span> server <span class="token operator" >=</span> <span class="token keyword" >await</span> io<span class="token punctuation" >.</span><span class="token function" >serve</span><span class="token punctuation" >(</span>handler<span class="token punctuation" >,</span> <span class="token string" >'localhost'</span><span class="token punctuation" >,</span> <span class="token number" >8080</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  <span class="token function" >print</span><span class="token punctuation" >(</span><span class="token string" >'Serving at http://${server.address.host}:${server.port}'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >class</span> <span class="token class-name" >TodosService</span> <span class="token punctuation" >{</span>
  <span class="token function" >getTodoList</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token keyword" >async</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token punctuation" >[</span>
      <span class="token punctuation" >{</span><span class="token string" >'name'</span><span class="token punctuation" >:</span> <span class="token string" >'Create Router'</span><span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >{</span><span class="token string" >'name'</span><span class="token punctuation" >:</span> <span class="token string" >'Create request handler'</span><span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >{</span><span class="token string" >'name'</span><span class="token punctuation" >:</span> <span class="token string" >'Send requests'</span><span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>And making the following request attempts to retrieve the name and length of the todos list:</p>
<p><code>http://localhost:8080/?paths=[[&quot;todos&quot;, &quot;name&quot;]]&amp;method=get</code></p>
<p>The following route will return this response:</p>
<pre><code class="language-dart"><span class="token punctuation" >{</span>
  <span class="token string" >"jsonGraph"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    <span class="token string" >"todos"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token string" >"name"</span><span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
        <span class="token string" >"Create Router"</span><span class="token punctuation" >,</span>
        <span class="token string" >"Create request handler"</span><span class="token punctuation" >,</span>
        <span class="token string" >"Send requests"</span>
      <span class="token punctuation" >]</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>If we want to get the length we can make this request:
<code>http://localhost:8080/?paths=[[&quot;todos&quot;, &quot;length&quot;]]</code></p>
<p>Which will return:</p>
<pre><code class="language-dart"><span class="token punctuation" >{</span>
  <span class="token string" >"jsonGraph"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    <span class="token string" >"todos"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token string" >"length"</span><span class="token punctuation" >:</span> <span class="token number" >3</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>And if we want to match both we can make the following request:</p>
<p><code>http://localhost:8080/?paths=[[&quot;todos&quot;, [&quot;name&quot;, &quot;length&quot;]]]</code></p>
<p>It will result in this response:</p>
<pre><code class="language-dart"><span class="token punctuation" >{</span>
  <span class="token string" >"jsonGraph"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    <span class="token string" >"todos"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token string" >"name"</span><span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
        <span class="token string" >"Create Router"</span><span class="token punctuation" >,</span>
        <span class="token string" >"Create request handler"</span><span class="token punctuation" >,</span>
        <span class="token string" >"Send requests"</span>
      <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
      <span class="token string" >"length"</span><span class="token punctuation" >:</span> <span class="token number" >3</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Pretty easy, huh? Just grab it and try it yourselves and I hope you like using falcor router!</p>

      </section>
    </article>

    <aside class="post">
      <div id="disqus_thread"></div>
      <script>
        (function() {
          var d = document, s = d.createElement('script');

          s.src = '//jesperh.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    </aside>


    </main>
    <footer class="site-footer">
      <section class="copyright">
        <a href="https://jesperh.se">Jesper Håkansson</a> &copy; 2016
        <a href="https://flic.kr/p/dz1YKB">Picture by JFXie used under CC BY</a>
      </section>
    </footer>
  </body>
</html>
